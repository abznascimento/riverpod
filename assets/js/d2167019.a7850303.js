"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[422],{5124:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return p},contentTitle:function(){return d},metadata:function(){return m},toc:function(){return u},default:function(){return f}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),l=a(6396),o=a(8215),s=["components"],p={title:".family"},d=void 0,m={unversionedId:"concepts/modifiers/family",id:"concepts/modifiers/family",title:".family",description:"p\xe1gina n\xe3o traduzida, ainda.",source:"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/concepts/modifiers/family.mdx",sourceDirName:"concepts/modifiers",slug:"/concepts/modifiers/family",permalink:"/docs/concepts/modifiers/family",editUrl:"https://github.com/rrousselGit/river_pod/edit/master/website/i18n/pt-BR/docusaurus-plugin-content-docs/current/concepts/modifiers/family.mdx",tags:[],version:"current",frontMatter:{title:".family"},sidebar:"Sidebar",previous:{title:"Combining Provider States",permalink:"/docs/concepts/combining_providers"},next:{title:".autoDispose",permalink:"/docs/concepts/modifiers/auto_dispose"}},u=[{value:"Usage",id:"usage",children:[],level:2},{value:"Parameter restrictions",id:"parameter-restrictions",children:[{value:"<em>PREFER</em> using <code>autoDispose</code> when the parameter is not constant:",id:"prefer-using-autodispose-when-the-parameter-is-not-constant",children:[],level:3}],level:2},{value:"Passing multiple parameters to a family",id:"passing-multiple-parameters-to-a-family",children:[],level:2}],c={toc:u};function f(e){var t=e.components,a=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"p\xe1gina n\xe3o traduzida, ainda."),(0,i.kt)("p",null,"Before reading this, consider reading about ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/providers"},"providers")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/reading"},"how to read them"),".\nIn this part, we will talk in detail about the ",(0,i.kt)("inlineCode",{parentName:"p"},".family")," provider modifier."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},".family")," modifier has one purpose: Getting a unique provider based on external parameters."),(0,i.kt)("p",null,"Some common use-cases for ",(0,i.kt)("inlineCode",{parentName:"p"},"family")," would be:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Combining ",(0,i.kt)("a",{parentName:"li",href:"../../providers/future_provider"},"FutureProvider")," with ",(0,i.kt)("inlineCode",{parentName:"li"},".family")," to fetch a ",(0,i.kt)("inlineCode",{parentName:"li"},"Message")," from its ID"),(0,i.kt)("li",{parentName:"ul"},"Passing the current ",(0,i.kt)("inlineCode",{parentName:"li"},"Locale")," to a provider, so that we can handle translations")),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("p",null,"The way families works is by adding an extra parameter to the provider.\nThis parameter can then be freely used in our provider to create some state."),(0,i.kt)("p",null,"For example, we can combine ",(0,i.kt)("inlineCode",{parentName:"p"},"family")," with ",(0,i.kt)("a",{parentName:"p",href:"../../providers/future_provider"},"FutureProvider")," to fetch\na ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," from its ID:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"final messagesFamily = FutureProvider.family<Message, String>((ref, id) async {\n  return dio.get('http://my_api.dev/messages/$id');\n});\n")),(0,i.kt)("p",null,"When using our ",(0,i.kt)("inlineCode",{parentName:"p"},"messagesFamily")," provider, the syntax is slightly different.",(0,i.kt)("br",{parentName:"p"}),"\n","The usual syntax will not work anymore:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build(BuildContext context, WidgetRef ref) {\n  // Error \u2013 messagesFamily is not a provider\n  final response = ref.watch(messagesFamily);\n}\n")),(0,i.kt)("p",null,"Instead, we need to pass a parameter to ",(0,i.kt)("inlineCode",{parentName:"p"},"messagesFamily"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build(BuildContext context, WidgetRef ref) {\n  final response = ref.watch(messagesFamily('id'));\n}\n")),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is possible to use a family with different parameters simultaneously.",(0,i.kt)("br",{parentName:"p"}),"\n","For example, we could use a ",(0,i.kt)("inlineCode",{parentName:"p"},"titleFamily")," to read both the French and English\ntranslations at the same time:"),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"@override\nWidget build(BuildContext context, WidgetRef ref) {\n  final frenchTitle = ref.watch(titleFamily(const Locale('fr')));\n  final englishTitle = ref.watch(titleFamily(const Locale('en')));\n\n  return Text('fr: $frenchTitle en: $englishTitle');\n}\n")))),(0,i.kt)("h2",{id:"parameter-restrictions"},"Parameter restrictions"),(0,i.kt)("p",null,"For families to work correctly, it is critical for the parameter passed to\na provider to have a consistent ",(0,i.kt)("inlineCode",{parentName:"p"},"hashCode")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"=="),"."),(0,i.kt)("p",null,"Ideally, the parameter should either be a primitive (bool/int/double/String),\na constant (providers), or an immutable object that overrides ",(0,i.kt)("inlineCode",{parentName:"p"},"==")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"hashCode"),"."),(0,i.kt)("h3",{id:"prefer-using-autodispose-when-the-parameter-is-not-constant"},(0,i.kt)("em",{parentName:"h3"},"PREFER")," using ",(0,i.kt)("inlineCode",{parentName:"h3"},"autoDispose")," when the parameter is not constant:"),(0,i.kt)("p",null,"You may want to use families to pass the input of a search field to your provider.\nBut that value can change often and never be reused.",(0,i.kt)("br",{parentName:"p"}),"\n","This could cause memory leaks as, by default, a provider is never destroyed even\nif no longer used."),(0,i.kt)("p",null,"Using both ",(0,i.kt)("inlineCode",{parentName:"p"},".family")," and ",(0,i.kt)("inlineCode",{parentName:"p"},".autoDispose")," fixes that memory leak:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"final characters = FutureProvider.autoDispose.family<List<Character>, String>((ref, filter) async {\n  return fetchCharacters(filter: filter);\n});\n")),(0,i.kt)("h2",{id:"passing-multiple-parameters-to-a-family"},"Passing multiple parameters to a family"),(0,i.kt)("p",null,"Families have no built-in support for passing multiple values to a provider."),(0,i.kt)("p",null,"On the other hand, that value could be ",(0,i.kt)("em",{parentName:"p"},"anything")," (as long as it matches with\nthe restrictions mentioned previously)."),(0,i.kt)("p",null,"This includes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A tuple from ",(0,i.kt)("a",{parentName:"li",href:"http://pub.dev/packages/tuple"},"tuple")),(0,i.kt)("li",{parentName:"ul"},"Objects generated with ",(0,i.kt)("a",{parentName:"li",href:"https://pub.dev/packages/freezed"},"Freezed")," or ",(0,i.kt)("a",{parentName:"li",href:"https://pub.dev/packages/built_value"},"built_value")),(0,i.kt)("li",{parentName:"ul"},"Objects using ",(0,i.kt)("a",{parentName:"li",href:"https://pub.dev/packages/equatable"},"equatable"))),(0,i.kt)("p",null,"Here's an example of using ",(0,i.kt)("a",{parentName:"p",href:"https://pub.dev/packages/freezed"},"Freezed")," or ",(0,i.kt)("a",{parentName:"p",href:"https://pub.dev/packages/equatable"},"equatable")," for multiple parameters:"),(0,i.kt)(l.Z,{groupId:"family",defaultValue:"freezed",values:[{label:"Freezed",value:"freezed"},{label:"Equatable",value:"equatable"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"freezed",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"@freezed\nabstract class MyParameter with _$MyParameter {\n  factory MyParameter({\n    required int userId,\n    required Locale locale,\n  }) = _MyParameter;\n}\n\nfinal exampleProvider = Provider.autoDispose.family<Something, MyParameter>((ref, myParameter) {\n  print(myParameter.userId);\n  print(myParameter.locale);\n  // Do something with userId/locale\n});\n\n@override\nWidget build(BuildContext context, WidgetRef ref) {\n  int userId; // Read the user ID from somewhere\n  final locale = Localizations.localeOf(context);\n\n  final something = ref.watch(\n    exampleProvider(MyParameter(userId: userId, locale: locale)),\n  );\n\n  ...\n}\n"))),(0,i.kt)(o.Z,{value:"equatable",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},"class MyParameter extends Equatable  {\n  MyParameter({\n    required this.userId,\n    required this.locale,\n  });\n\n  final int userId;\n  final Locale locale;\n\n  @override\n  List<Object> get props => [userId, locale];\n}\n\nfinal exampleProvider = Provider.family<Something, MyParameter>((ref, myParameter) {\n  print(myParameter.userId);\n  print(myParameter.locale);\n  // Do something with userId/locale\n});\n\n@override\nWidget build(BuildContext context, WidgetRef ref) {\n  int userId; // Read the user ID from somewhere\n  final locale = Localizations.localeOf(context);\n\n  final something = ref.watch(\n    exampleProvider(MyParameter(userId: userId, locale: locale)),\n  );\n\n  ...\n}\n")))))}f.isMDXComponent=!0}}]);